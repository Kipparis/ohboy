_TODO:_
+ сделать отдельную ссылку для тех, кому нужен просто код
# Пишем эксель скрипт для учёта личных финансов  
## 1. Зачем?  
  
  Строго субъективное наблюдение, что достаточно сложно нон-стоп следить за своими ресурсами. 

## 2. Нашёл я библиотеку  
Не потратив на поиски и 10 минут, открыл первую вкладку в гугле и посмотрел чтобы в моей избраннице было:  
+ Создание нескольких листов  
+ Считывание уже готового файла  
+ Остальное не имеет значения, только удобство увеличивает  

Итак мы будем использовать библиотеку openpyxl  

Дабы облегчить себе жизнь, разделим всю программу на две подзадачи:  
1. Написать скрипт для создания новой таблицы   
2. Написать скрипт для собственно добавления новой строчки в таблицу  

На счёт первого пункта может показаться что это не лучшая идея, но с другой стороны, достаточно просто завести гитхаб аккаунт, выучить пару команд на гите и случайные ошибки не будут иметь никакого влияния.  
  
Немного посмотрев документацию, выделяем для себя функции, которые будут наиболее важны:  
+ создание объекта и первого листа в нём:
```
from openpyxl import Workbook, load_workbook
wb = Workbook() # Для создания объекта таблицы
ws = wb.active # Обращаемся к первой странице таблицы
```
+ задать значение ячейки А1 ( как и любой другой ) можно следующими методами:
```
ws['A1'] = value
d = ws.cell(row=1, column=1, value=value) # Задаёт значение и возвращает ячейку

cell = ws['A1']
cell.value = value
```
+ Сохранения в файл
```
wb.save('file.xlsx')
```
С остальным разберёмся по ходу дела :)

Стоит отметить что листы ( как и ячейки ) создаются при любом обращении к ним

Так как нам надо отдельно создавать таблицу и её редактировать, возьпользуемся преимуществом ключей.  
Для этого подключим библиотеку sys ( заодно и библиотеки для excel )
```
import sys
from openpyxl import Workbook, load_workbook
```
Если один из ключей -maketable, надо задать таблицу
```
for arg in sys.argv:
    if arg in "-maketable":
        wb = Workbook() # создаём объект
        pays = wb.active # создаём главную страницу
        pays.title = "Pays" # Даём ей имя Pays

        pays["A1"] = "Days" # Самый левый столбец будет отвечать за дни 

        days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'] # Массив для дальнейшего заполнения остальных столбцов
        spec = ['name', 'cost', 'general cost'] # Для подстолбцов

        # Склеиваем верхние стобцы по три семь раз ( в соответствии каждому дню )
        for i in range(1, 8):
            curr_col = i * 3 - 1
            next_col = i * 3 + 1

            pays.merge_cells(start_row=1, end_row=1, start_column=curr_col, end_column=next_col)
            curr_cell = pays.cell(row=1, column=curr_col, value=days[i - 1])
```
На данном этапе у нас получается следующая таблица  
![Image alt](https://github.com/Kipparis/ohboy/raw/excel_python/fin/readme/1.png)  